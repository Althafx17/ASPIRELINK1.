<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aspirelink Chat Interface</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    display: flex;
    background-color: #f4f4f4;
  }
  .sidebar {
    background-color: #4399FF;
    position: fixed;
    color: white;
    width: 300px;
    height: 100vh;
    padding: 20px;
  }
  .sidebar ul {
    list-style: none;
    padding: 0;
    display: flex;
    justify-content: center;
    flex-direction: column;
    align-items: center;
  }
  .sidebar ul li {
    height: 40px;
    cursor: pointer;
    width: 300px;
    display: flex;
    border-radius: 7px;
    justify-content: center;
    align-items: center;
    margin-bottom: 2rem;
    color: black;
    background-color: white;
  }

  .sidebar ul li:hover {
    background-color: #f4f4f4;
  }
  .content {
    margin-left: 340px;
    flex-grow: 1;
    background-color: #f4f4f4;
    padding: 20px;
  }
  .report {
    background-color: #ddd;
    padding: 10px;
    margin-bottom: 20px;
  }
  .chat-window {
    border: 1px solid #ccc;
    padding: 20px;
    height: 300px;
    overflow-y: auto;
  }
  .person{
    display: flex;gap: 40px;align-items: center;margin-bottom: 1rem;border-bottom: .6px solid #ccc;
  }
</style>
</head>
<body onload="onloadDashboard()">
  <div class="sidebar">
    <ul>
      <li onclick="mentor()">Mentors</li>
      <li onclick="student()">Students</li>
      <li onclick="report()">Reports Received</li>
      <li onclick="addRoom()">Add Room</li>

      <li onclick="logout()">Logout</li>

    </ul>
  </div>
  <div id="mentor" onclick="mentor()" class="content">
    <h1>Mentors</h1>
    <div class="count" style="display: flex;gap: 20px;align-items: center;margin-bottom: 1rem;">
        <h3 id="mentorCount"></h3>
        <p>|</p>
        <p>Available Mentors</p>
    </div>
    <div id="mentorList" class="person-list" style="padding: 30px;overflow-y: scroll;">
   
        
    </div>

  </div>
  <div id="student" style="display: none;" class="content 2">
    <h1>Students</h1>
    <div class="count" style="display: flex;gap: 20px;align-items: center;margin-bottom: 1rem;">
        <h3 id="studentCount"></h3>
        <p>|</p>
        <p>Available Students</p>
    </div>
    <div id="studentList" class="person-list" style="padding: 30px;overflow-y: scroll;">
  
        
    </div>

  </div>
  <div id="report"  class="content 3" style="display: none;">
    <div class="report">
        <h3 id="reportCount"></h3>
        <p>Report Received from user</p>
      </div>
      <div id="reportList" class="person-list" style="padding: 30px;overflow-y: scroll;">
        
    </div>
  </div>

  <div id="addRoom"  class="content 4" style="display: none;">
    
    <form action="/addRoom" method="post">

      <input type="text" name="roomId" placeholder="Room id" required>
      <input type="text" name="roomType" placeholder="Room  Name" required>
      <input type="text" name="roomCapacity" placeholder="Room Capacity" required>
      <input type="submit" value="Add Room">

    </form>
  </div>

  <script>




    let mentorList = document.getElementById('mentorList');
    let studentList = document.getElementById('studentList');
    let reportList = document.getElementById('reportList');
    let mentorCount = document.getElementById('mentorCount');
    let studentCount = document.getElementById('studentCount');
    let reportCount = document.getElementById('reportCount');

    function onloadDashboard() {
      mentor();
    }

    function mentor() {
      document.getElementById('mentor').style.display = 'block';
      document.getElementById('student').style.display = 'none';
      document.getElementById('report').style.display = 'none';
      document.getElementById('addRoom').style.display = 'none';

      fetch('/allMentors')
        .then(res => res.json())
        .then(data => {

            mentorList.innerHTML = '';
            mentorCount.innerHTML = data.length;
            data.forEach(element => {
                mentorList.innerHTML += `
                <div class="person">
                    <img src="/images/mentor.png" style="width: 40px;height: 40px;border-radius: 50%; background-color: #4399FF;" alt="">
                    <p>${element.fname}</p>
                    <p>${element.email}</p>
                    <p>${element.username}</p>    
                    <p>${element.subject}</p>
                    <p>${element.qualification}</p>
                    <div class="" onclick="remove(this)"><img src="/images/delete.png" style="width: 30px;height: 30px;" alt=""></div>
                </div>
                `

            });
        })
    }
    function student() {
      document.getElementById('mentor').style.display = 'none';
      document.getElementById('student').style.display = 'block';
      document.getElementById('report').style.display = 'none';
      document.getElementById('addRoom').style.display = 'none';

        fetch('/allStudents')
            .then(res => res.json())
            .then(data => {
                
                studentList.innerHTML = '';
                studentCount.innerHTML = data.length;
                data.forEach(element => {
                    studentList.innerHTML += `
                    <div class="person">
                        <img src="/images/student.png" style="width: 40px;height: 40px;border-radius: 50%; background-color: #4399FF;" alt="">
                        <p>${element.fname}</p>
                        <p>${element.email}</p>
                        <p>${element.username}</p>    
                        <p>${element.subject}</p>
                        <p>${element.qualification}</p>
                        <div class="" onclick="remove(this)"><img src="/images/delete.png" style="width: 30px;height: 30px;" alt=""></div>
                    </div>
                    `
                });

            })
    }
    function report() {
      document.getElementById('mentor').style.display = 'none';
      document.getElementById('student').style.display = 'none';
      document.getElementById('report').style.display = 'block';
      document.getElementById('addRoom').style.display = 'none';


        fetch('/allReports')
            .then(res => res.json())
            .then(data => {
                

                reportList.innerHTML = '';
                reportCount.innerHTML = data.length;
                data.forEach(element => {
                    reportList.innerHTML += `
                    <div class="person">
                        <img src="/images/profile.png" style="width: 40px;height: 40px;border-radius: 50%; background-color: #4399FF;" alt="">
                        <p>${element.user}</p>
                        <p>${element.reason}</p>
                        <div class="" onclick="removeReport(this)"><img src="/images/delete.png" style="width: 30px;height: 30px;" alt=""></div>
                    </div>
                    `
                });

            })
    }


    function removeReport(e) {
        let user = e.parentElement.children[1].innerText;
        
        fetch('/removeReport', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({user})
        })
        .then(res => res.json())
        .then(data => {
            alert('Report removed successfully');
            console.log(data);
            report();
            
        })
    }

    function remove(e) {
        let username = e.parentElement.children[3].innerText;
        
        fetch('/removeUser', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({username})
        })
        .then(res => res.json())
        .then(data => {
            alert('User removed successfully');
            console.log(data);
            mentor();
            
        })
    }

    function logout() {
        document.cookie = 'adminUsername=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        window.location.href = '/admin';
    }


    function addRoom(){
      
      document.getElementById('mentor').style.display = 'none';
      document.getElementById('student').style.display = 'none';
      document.getElementById('report').style.display = 'none';
      document.getElementById('addRoom').style.display = 'block';

    }

  </script>
</body>
</html>