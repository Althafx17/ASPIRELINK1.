<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aspire Link</title>
    <link href="style.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"
    integrity="sha512-Xm9qbB6Pu06k3PUwPj785dyTl6oHxgsv9nHp7ej7nCpAqGZT3OZpsELuCYX05DdonFpTlBpXMOxjavIAIUwr0w=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script defer src="app.js"></script>
</head>

<body onload="fill()">
    <main >
      
        <div class="" style="display: flex;justify-content: space-evenly;">
            <div class="left" style="width: 20%;height: 100%;">
                <p class="user-list" ></p>
            </div>
            <div class="right" style="width: 80%;height: 100vh;">
             <form class="form-join" style="display: none;">
                 <input type="text" id="name" maxlength="8" placeholder="Your name" size="5" required>
                 <input type="text" id="room" placeholder="Chat room" size="5" required>
                 <button id="join" type="submit">Join</button>
             </form>
     
             <ul class="chat-display" style="width: 100%;height: 85%;max-width: 100%;margin: 0;"></ul>
     
             <p class="activity"></p>
     
             <form class="form-msg" style="margin: 0;max-width: 100%;height: 50px;">
                 <input type="text" id="message" placeholder="Your message" required>
                 <button type="submit" style="background-color: #4399FF;">Send</button>
             </form>
            </div>
        </div>
    </main>
</body>

<script>
    // 


    function fill(){

        document.getElementById("name").value = getCookie("username")
        document.getElementById('room').value = getCookie("roomId")
        document.getElementById('join').click()
       

    }


    function getCookie(cname) {
    let name = cname + "=";
    let decodedCookie = decodeURIComponent(document.cookie);
    let ca = decodedCookie.split(';');
    for(let i = 0; i <ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
        c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
        }
    }
    return "";
    }

    function reportUser(e){
       
        let reason = prompt("Enter the reason for reporting")

        if(reason){
            let data = {
            user: e.previousSibling.innerText,
            reason: reason
        }
        fetch('/reportUser',{
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        }).then(()=>{
            alert('User reported successfully')
            window.location.href = '/'
        })
        }
        else{
            alert('Please enter a reason')
        }
      
    }
</script>

</html>
